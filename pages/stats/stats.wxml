<view class="container">
  <!-- å¤´éƒ¨ç­›é€‰ -->
  <view class="header">
    <view class="home-btn" bindtap="goHome">ğŸ  é¦–é¡µ</view>
    <view class="type-switch">
      <view class="item {{type === 'expense' ? 'active expense' : ''}}" bindtap="changeType" data-type="expense">æ”¯å‡º</view>
      <view class="item {{type === 'income' ? 'active income' : ''}}" bindtap="changeType" data-type="income">æ”¶å…¥</view>
    </view>
    
    <view class="range-switch">
      <text class="{{rangeType === 'month' ? 'active' : ''}}" bindtap="changeRange" data-type="month">æŒ‰æœˆ</text>
      <text class="{{rangeType === 'year' ? 'active' : ''}}" bindtap="changeRange" data-type="year">æŒ‰å¹´</text>
    </view>
  </view>

  <view class="date-picker-row">
    <picker mode="date" fields="{{rangeType}}" value="{{date}}" bindchange="onDateChange">
      <view class="picker">{{date}} â–¼</view>
    </picker>
    <view class="total-box">
      å…±{{type === 'expense' ? 'æ”¯å‡º' : 'æ”¶å…¥'}}: <text class="amount">{{totalAmount}}</text>
    </view>
  </view>

  <!-- è¶‹åŠ¿å›¾ (ç®€æ˜“æŸ±çŠ¶å›¾) -->
  <view class="chart-container">
    <view class="chart-title">è¶‹åŠ¿åˆ†æ</view>
    <scroll-view scroll-x class="bar-chart">
      <view class="bar-item" wx:for="{{trendData}}" wx:key="label">
        <view class="bar-wrap">
          <view class="bar {{type}}" style="height: {{item.height}}%"></view>
        </view>
        <view class="label">{{item.label}}</view>
      </view>
    </scroll-view>
  </view>

  <!-- åˆ†ç±»å æ¯” -->
  <view class="category-list">
    <view class="chart-title">åˆ†ç±»æ’è¡Œæ¦œ</view>
    <view class="cat-item" wx:for="{{categoryStats}}" wx:key="name">
      <view class="cat-info">
        <text class="cat-icon">{{item.icon}}</text>
        <text class="cat-name">{{item.name}}</text>
        <text class="cat-percent">{{item.percent}}%</text>
        <text class="cat-amount">{{item.amount}}</text>
      </view>
      <view class="progress-bg">
        <view class="progress-fill {{type}}" style="width: {{item.percent}}%"></view>
      </view>
    </view>
    <view wx:if="{{categoryStats.length === 0}}" class="empty">æš‚æ— è®°å½•</view>
  </view>

  <!-- æˆå‘˜å æ¯” -->
  <view class="category-list" style="margin-top: 0;">
    <view class="chart-title">æˆå‘˜{{type === 'expense' ? 'æ¶ˆè´¹' : 'è´¡çŒ®'}}å æ¯”</view>
    <view class="cat-item" wx:for="{{memberStats}}" wx:key="name">
      <view class="cat-info">
        <text class="cat-name">{{item.name}}</text>
        <text class="cat-percent">{{item.percent}}%</text>
        <text class="cat-amount">{{item.amount}}</text>
      </view>
      <view class="progress-bg">
        <view class="progress-fill {{type}}" style="width: {{item.percent}}%"></view>
      </view>
    </view>
    <view wx:if="{{memberStats.length === 0}}" class="empty">æš‚æ— è®°å½•</view>
  </view>
</view>
