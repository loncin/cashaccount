"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = {
    sortStringify(o, replace) {
        if (o && Object.prototype.toString.call(o) === '[object Object]') {
            let obj = {};
            Object.keys(o)
                .sort((a, b) => a - b)
                .forEach((v) => {
                obj[v] = o[v];
            });
            o = obj;
        }
        return JSON.stringify(o, replace, null);
    },
    parse(text, replace) {
        if (typeof text !== 'string') {
            return text;
        }
        try {
            let res_text = text.replace(/(?<=:)\s*(\d{15,}|(\d+\.\d+))/g, (v) => {
                if (v.trim().length > 15) {
                    v = '"' + v + '"';
                }
                return v;
            });
            return JSON.parse(res_text, replace);
        }
        catch (e) {
            console.error('first replace err ', e);
            console.error('text = ', text);
            try {
                return JSON.parse(text, replace);
            }
            catch (e) {
                console.error('second replace err ', e);
                console.error('text = ', text);
                return text;
            }
        }
    },
    redisConfigParse(redisConfigs) {
        try {
            if (Object.prototype.toString.call(redisConfigs) === '[object Object]') {
                return redisConfigs;
            }
            const redis = {};
            redisConfigs
                .split('|')
                .map((group) => group.split(','))
                .map((group) => {
                return group.map((item) => {
                    const [host, port] = item.split(':');
                    return {
                        host,
                        port,
                    };
                });
            })
                .forEach((item, idx) => {
                redis[`conf${idx + 1}`] = item;
            });
            return redis;
        }
        catch (error) {
            console.error(`redis config serialize error`);
        }
    },
};
