"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function default_1(fn, context) {
    return function (...args) {
        let pro = new Promise(function (resolve, reject) {
            let callbackIndex = args.findIndex(arg => typeof arg === 'function');
            if (callbackIndex !== -1) {
                let callback = args[callbackIndex];
                args[callbackIndex] = function (...args) {
                    callback.apply(null, args);
                    pro['args'] = args;
                    if (args[0]) {
                        reject(args[0]);
                    }
                    resolve(args[1]);
                };
            }
            fn.apply(context || this, args.concat(callbackIndex !== -1
                ? []
                : function (...args) {
                    pro['args'] = args;
                    if (args[0]) {
                        reject(args[0]);
                    }
                    resolve(args[1]);
                }));
        });
        return pro;
    };
}
exports.default = default_1;
